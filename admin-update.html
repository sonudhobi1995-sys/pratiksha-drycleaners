<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin App | PRATIKSHA</title>
    
    <link rel="manifest" href="manifest-admin.json">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#001F3F">

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --sun: #FF8C00; --dark: #001F3F; --green: #2E8B57; --bg: #f0f2f5; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); margin: 0; padding-bottom: 20px; }
        
        .app-header { 
            background: linear-gradient(135deg, var(--dark) 0%, #003366 100%); 
            color: white; padding: 25px 15px; text-align: center; 
            border-radius: 0 0 30px 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); 
        }
        .app-logo {
            width: 80px; height: 80px; border-radius: 50%;
            background: white; padding: 5px; margin-bottom: 10px;
            border: 3px solid var(--sun); box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            object-fit: contain;
        }

        .container { padding: 20px; max-width: 500px; margin: auto; }
        .card { background: white; padding: 25px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); margin-bottom: 20px; border: 1px solid #e0e0e0; }
        
        h3 { color: var(--dark); margin-top: 0; display: flex; align-items: center; gap: 10px; font-size: 1.2rem; }
        label { font-size: 0.85rem; font-weight: 600; color: #555; margin-left: 5px; }

        input, select { width: 100%; padding: 14px; margin: 8px 0 18px 0; border-radius: 12px; border: 1.5px solid #ddd; box-sizing: border-box; font-size: 1rem; transition: 0.3s; }
        
        .input-group { display: flex; gap: 8px; margin: 8px 0 18px 0; }
        .input-group input { margin: 0; flex: 1; }
        .btn-contact { padding: 0 15px; border-radius: 12px; border: 1.5px solid #ddd; background: #fff; cursor: pointer; font-size: 1.2rem; transition: 0.3s; display: flex; align-items: center; }

        .btn { width: 100%; padding: 16px; border: none; border-radius: 12px; font-weight: 700; font-size: 1rem; cursor: pointer; transition: 0.3s; display: flex; justify-content: center; align-items: center; gap: 10px; margin-bottom: 15px; text-decoration: none;}
        .btn-status { background: var(--dark); color: white; }
        .btn-pickup { background: var(--green); color: white; }
        .btn-billing { background: var(--sun); color: white; box-shadow: 0 4px 10px rgba(255,140,0,0.3); }
        .btn-dashboard { background: #34495e; color: white; border: 2px solid var(--sun); }
        .btn:active { transform: scale(0.98); }
        .badge { background: var(--sun); color: white; padding: 4px 10px; border-radius: 20px; font-size: 0.7rem; text-transform: uppercase; }
    </style>
</head>
<body>

    <div class="app-header">
        <img src="logo.png" alt="PRATIKSHA" class="app-logo">
        <h2 style="margin:0; letter-spacing: 1px;">рдкреНрд░рддреАрдХреНрд╖рд╛ рдПрдбрдорд┐рди рдкреИрдирд▓</h2>
        <span class="badge">рдореБрдЦреНрдп рдореИрдиреЗрдЬрд░</span>
    </div>

    <div class="container">
        <div class="card" style="border-bottom: 4px solid var(--sun);">
            <h3>ЁЯУК рд╡реНрдпрд╛рдкрд╛рд░ рдХреА рд╕реНрдерд┐рддрд┐</h3>
            <button class="btn btn-dashboard" onclick="window.location.href='Dashboard.html'">
                ЁЯУИ рдЖрдЬ рдХреА рд░рд┐рдкреЛрд░реНрдЯ (Dashboard) рджреЗрдЦреЗрдВ
            </button>
        </div>

        <div class="card">
            <h3>ЁЯФД рдХреНрд╡рд┐рдХ рдЕрдкрдбреЗрдЯ</h3>
            <label>рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░:</label>
            <div class="input-group">
                <input type="tel" id="adminMobile" placeholder="98XXXXXXXX">
                <button type="button" class="btn-contact" onclick="getContact('adminMobile')" title="рдХреЙрдиреНрдЯреИрдХреНрдЯ рдЪреБрдиреЗрдВ">
                    ЁЯСд
                </button>
            </div>
            
            <label>рдСрд░реНрдбрд░ рд╕реНрдерд┐рддрд┐:</label>
            <select id="adminStatus">
                <option value="рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ">ЁЯз║ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ</option>
                <option value="рдзреБрд▓рд╛рдИ">ЁЯз╝ рдзреБрд▓рд╛рдИ</option>
                <option value="рдЖрдпрд░рдирд┐рдВрдЧ">ЁЯСФ рдЖрдпрд░рдирд┐рдВрдЧ</option>
                <option value="рд░реЗрдбреА рдЯреВ рдбрд┐рд▓реАрд╡рд░реА">тЬЕ рд░реЗрдбреА рдЯреВ рдбрд┐рд▓реАрд╡рд░реА</option>
                <option value="Delivered">ЁЯЪЪ рдбрд┐рд▓реАрд╡рд░ рдХрд░ рджрд┐рдпрд╛</option>
            </select>
            <button class="btn btn-status" id="updateBtn" onclick="updateStatusOnly()">
                рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ рдФрд░ рдореИрд╕реЗрдЬ рднреЗрдЬреЗрдВ
            </button>
        </div>

        <div class="card" style="border-left: 5px solid var(--sun);">
            <h3>ЁЯЪА рдХреНрд╡рд┐рдХ рдиреЗрд╡рд┐рдЧреЗрд╢рди</h3>
            <button class="btn btn-pickup" onclick="window.location.href='driver-app.html'">
                ЁЯЪЪ рдбреНрд░рд╛рдЗрд╡рд░ рдРрдк (Pickup)
            </button>
            <button class="btn btn-billing" onclick="window.location.href='billing.html'">
                ЁЯз╛ рдмрд┐рд▓рд┐рдВрдЧ рдРрдк (Billing)
            </button>
        </div>
    </div>

<script>
    // рдЖрдкрдХрд╛ рддрд╛рдЬрд╝рд╛ рд░рд╛рдордмрд╛рдг URL
    const scriptURL = 'https://script.google.com/macros/s/AKfycbx-Cu2CNgnLn6685hq40wxSW1AzK5fXJx91fDUGVEJvhvq8eDxRSZ7fhKDFrCCT2p8/exec';

    async function getContact(mobileId) {
        if (!('contacts' in navigator)) return alert("рдХреНрд╖рдорд╛ рдХрд░реЗрдВ, рдпрд╣ рдлреАрдЪрд░ рдХреЗрд╡рд▓ Android Chrome рдкрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред");
        try {
            const props = ['tel'];
            const contacts = await navigator.contacts.select(props, {multiple: false});
            if (contacts.length > 0) {
                let rawNum = contacts[0].tel[0].replace(/\D/g, '');
                document.getElementById(mobileId).value = rawNum.length > 10 ? rawNum.slice(-10) : rawNum;
            }
        } catch (err) { console.log(err); }
    }

    function updateStatusOnly() {
        const mobile = document.getElementById('adminMobile').value;
        const status = document.getElementById('adminStatus').value;
        const btn = document.getElementById('updateBtn');
        
        if(!mobile || mobile.length < 10) return alert("рд╕рд╣реА рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░ рдбрд╛рд▓реЗрдВ");

        btn.innerText = "рдЕрдкрдбреЗрдЯ рд╣реЛ рд░рд╣рд╛ рд╣реИ...";
        btn.disabled = true;

        // "Fire & Forget" рд░рд╛рдордмрд╛рдг рддрд░реАрдХрд╛ (no-cors)
        const finalURL = `${scriptURL}?action=updateStatus&mobile=${mobile}&status=${encodeURIComponent(status)}`;
        
        fetch(finalURL, { 
            method: 'GET',
            mode: 'no-cors' 
        });

        // рдЬрд╡рд╛рдм рдХрд╛ рдЗрдВрддрдЬрд╝рд╛рд░ рдХрд┐рдП рдмрд┐рдирд╛ рд╡реНрд╣рд╛рдЯреНрд╕рдПрдк рдЦреЛрд▓рдирд╛ рдФрд░ рд╕рдлрд▓рддрд╛ рджрд┐рдЦрд╛рдирд╛
        setTimeout(() => {
            alert("рд╕реНрдЯреЗрдЯрд╕ рдЕрдкрдбреЗрдЯ рдбреЗрдЯрд╛ рднреЗрдЬ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ! тЬЕ");
            
            const waMsg = `*рдкреНрд░рддреАрдХреНрд╖рд╛ рдбреНрд░рд╛рдИ рдХреНрд▓реАрдирд░реНрд╕* ЁЯз║тЬи\n\nрдирдорд╕реНрддреЗ,\nрдЖрдкрдХреЗ рдСрд░реНрдбрд░ рдХрд╛ рд╕реНрдЯреЗрдЯрд╕ рдЕрдм *${status}* рд╣реИред\n\nрдзрдиреНрдпрд╡рд╛рдж! ЁЯЩП`;
            window.open(`https://wa.me/91${mobile}?text=${encodeURIComponent(waMsg)}`, '_blank');
            
            location.reload();
        }, 1500);
    }
</script>

</body>
</html>
